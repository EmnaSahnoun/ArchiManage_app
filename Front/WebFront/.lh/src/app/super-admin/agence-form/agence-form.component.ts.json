{
    "sourceFile": "src/app/super-admin/agence-form/agence-form.component.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 58,
            "patches": [
                {
                    "date": 1744024184352,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1744024190281,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,6 @@\n import { Component } from '@angular/core';\r\n+import { FormGroup } from '@angular/forms';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n   templateUrl: './agence-form.component.html',\r\n"
                },
                {
                    "date": 1744024201957,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n import { Component } from '@angular/core';\r\n-import { FormGroup } from '@angular/forms';\r\n+import { FormBuilder, FormGroup } from '@angular/forms';\r\n+import { MatDialogRef } from '@angular/material/dialog';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n   templateUrl: './agence-form.component.html',\r\n"
                },
                {
                    "date": 1744024216169,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import { Component } from '@angular/core';\r\n import { FormBuilder, FormGroup } from '@angular/forms';\r\n-import { MatDialogRef } from '@angular/material/dialog';\r\n+import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n   templateUrl: './agence-form.component.html',\r\n"
                },
                {
                    "date": 1744024225934,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n-import { Component } from '@angular/core';\r\n-import { FormBuilder, FormGroup } from '@angular/forms';\r\n+import { Component, Inject } from '@angular/core';\r\n+import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n"
                },
                {
                    "date": 1744024233240,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-import { Component, Inject } from '@angular/core';\r\n+import { Component, Inject, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n \r\n @Component({\r\n"
                },
                {
                    "date": 1744026012686,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,32 +9,36 @@\n })\r\n export class AgenceFormComponent implements OnInit {\r\n   agenceForm: FormGroup;\r\n   isEditMode = false;\r\n+  agencyData: any;\r\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n-    public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n-    @Inject(MAT_DIALOG_DATA) public data: any\r\n+    public activeModal: NgbActiveModal\r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n       address: ['', Validators.required],\r\n       email: ['', [Validators.required, Validators.email]],\r\n-      phone: ['', Validators.required],\r\n+      phone: ['', Validators.required]\r\n     });\r\n+  }\r\n \r\n-    if (data?.agency) {\r\n+  ngOnInit(): void {\r\n+    if (this.agencyData) {\r\n       this.isEditMode = true;\r\n-      this.agenceForm.patchValue(data.agency);\r\n+      this.agenceForm.patchValue(this.agencyData);\r\n     }\r\n   }\r\n \r\n-  ngOnInit(): void {}\r\n-\r\n-  onSubmit() {\r\n+  onSubmit(): void {\r\n     if (this.agenceForm.valid) {\r\n-      this.dialogRef.close(this.agenceForm.value);\r\n+      this.activeModal.close(this.agenceForm.value);\r\n     }\r\n   }\r\n \r\n+  close(): void {\r\n+    this.activeModal.dismiss();\r\n+  }\r\n+\r\n }\r\n"
                },
                {
                    "date": 1744027481015,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,8 @@\n import { Component, Inject, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n+import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n   templateUrl: './agence-form.component.html',\r\n"
                },
                {
                    "date": 1744027563906,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,9 +14,10 @@\n   agencyData: any;\r\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n-    public activeModal: NgbActiveModal\r\n+    public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n+    @Inject(MAT_DIALOG_DATA) public data: any\r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n       address: ['', Validators.required],\r\n"
                },
                {
                    "date": 1744027578448,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,10 +14,9 @@\n   agencyData: any;\r\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n-    public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n-    @Inject(MAT_DIALOG_DATA) public data: any\r\n+    public activeModal: NgbActiveModal\r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n       address: ['', Validators.required],\r\n"
                },
                {
                    "date": 1744027585942,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,7 @@\n import { Component, Inject, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n-import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n   templateUrl: './agence-form.component.html',\r\n"
                },
                {
                    "date": 1744027593398,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,8 @@\n import { Component, Inject, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n+import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n   templateUrl: './agence-form.component.html',\r\n@@ -13,9 +14,10 @@\n   agencyData: any;\r\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n-    public activeModal: NgbActiveModal\r\n+    public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n+    @Inject(MAT_DIALOG_DATA) public data: any\r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n       address: ['', Validators.required],\r\n"
                },
                {
                    "date": 1744027605351,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,11 +33,11 @@\n     }\r\n   }\r\n \r\n   onSubmit(): void {\r\n-    if (this.agenceForm.valid) {\r\n+   /*  if (this.agenceForm.valid) {\r\n       this.activeModal.close(this.agenceForm.value);\r\n-    }\r\n+    } */\r\n   }\r\n \r\n   close(): void {\r\n     this.activeModal.dismiss();\r\n"
                },
                {
                    "date": 1744027912473,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,9 +24,8 @@\n       email: ['', [Validators.required, Validators.email]],\r\n       phone: ['', Validators.required]\r\n     });\r\n   }\r\n-\r\n   ngOnInit(): void {\r\n     if (this.agencyData) {\r\n       this.isEditMode = true;\r\n       this.agenceForm.patchValue(this.agencyData);\r\n"
                },
                {
                    "date": 1744027926086,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,15 +24,17 @@\n       email: ['', [Validators.required, Validators.email]],\r\n       phone: ['', Validators.required]\r\n     });\r\n   }\r\n+\r\n   ngOnInit(): void {\r\n-    if (this.agencyData) {\r\n-      this.isEditMode = true;\r\n-      this.agenceForm.patchValue(this.agencyData);\r\n-    }\r\n+  if (this.data && this.data.isEditMode) {\r\n+    this.isEditMode = true;\r\n+    this.agenceForm.patchValue(this.data.agency);\r\n   }\r\n+}\r\n \r\n+\r\n   onSubmit(): void {\r\n    /*  if (this.agenceForm.valid) {\r\n       this.activeModal.close(this.agenceForm.value);\r\n     } */\r\n"
                },
                {
                    "date": 1744027937495,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,15 +33,16 @@\n   }\r\n }\r\n \r\n \r\n-  onSubmit(): void {\r\n-   /*  if (this.agenceForm.valid) {\r\n-      this.activeModal.close(this.agenceForm.value);\r\n-    } */\r\n+onSubmit(): void {\r\n+  if (this.agenceForm.valid) {\r\n+    this.dialogRef.close(this.agenceForm.value);\r\n   }\r\n+}\r\n \r\n-  close(): void {\r\n-    this.activeModal.dismiss();\r\n-  }\r\n+close(): void {\r\n+  this.dialogRef.close();\r\n+}\r\n \r\n+\r\n }\r\n"
                },
                {
                    "date": 1744028052344,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,12 +26,14 @@\n     });\r\n   }\r\n \r\n   ngOnInit(): void {\r\n-  if (this.data && this.data.isEditMode) {\r\n-    this.isEditMode = true;\r\n-    this.agenceForm.patchValue(this.data.agency);\r\n+    if (this.agencyData) {\r\n+      this.isEditMode = true;\r\n+      this.agenceForm.patchValue(this.agencyData);\r\n+    }\r\n   }\r\n+  \r\n }\r\n \r\n \r\n onSubmit(): void {\r\n"
                },
                {
                    "date": 1744028249856,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,54 @@\n+import { Component, Inject, OnInit } from '@angular/core';\r\n+import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n+import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n+import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n+\r\n+@Component({\r\n+  selector: 'app-agence-form',\r\n+  templateUrl: './agence-form.component.html',\r\n+  styleUrl: './agence-form.component.scss'\r\n+})\r\n+export class AgenceFormComponent implements OnInit {\r\n+  agenceForm: FormGroup;\r\n+  isEditMode = false;\r\n+  agencyData: any;\r\n+\r\n+  constructor(\r\n+    private fb: FormBuilder,\r\n+    public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n+    @Inject(MAT_DIALOG_DATA) public data: any\r\n+  ) {\r\n+    this.agenceForm = this.fb.group({\r\n+      name: ['', Validators.required],\r\n+      address: ['', Validators.required],\r\n+      email: ['', [Validators.required, Validators.email]],\r\n+      phone: ['', Validators.required]\r\n+    });\r\n+  \r\n+    if (data?.isEditMode && data?.agencyData) {\r\n+      this.isEditMode = true;\r\n+      this.agenceForm.patchValue(data.agencyData);\r\n+    }\r\n+  }\r\n+\r\n+  ngOnInit(): void {\r\n+    if (this.agencyData) {\r\n+      this.isEditMode = true;\r\n+      this.agenceForm.patchValue(this.agencyData);\r\n+    }\r\n+  }\r\n+  \r\n+\r\n+\r\n+onSubmit(): void {\r\n+  if (this.agenceForm.valid) {\r\n+    this.dialogRef.close(this.agenceForm.value);\r\n+  }\r\n+}\r\n+\r\n+close(): void {\r\n+  this.dialogRef.close();\r\n+}\r\n+\r\n+\r\n+}\r\n"
                },
                {
                    "date": 1744028271053,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,74 +23,20 @@\n       address: ['', Validators.required],\r\n       email: ['', [Validators.required, Validators.email]],\r\n       phone: ['', Validators.required]\r\n     });\r\n-  \r\n-    if (data?.isEditMode && data?.agencyData) {\r\n-      this.isEditMode = true;\r\n-      this.agenceForm.patchValue(data.agencyData);\r\n-    }\r\n   }\r\n \r\n   ngOnInit(): void {\r\n-    if (this.agencyData) {\r\n-      this.isEditMode = true;\r\n-      this.agenceForm.patchValue(this.agencyData);\r\n-    }\r\n+  if (this.agencyData) {\r\n+    this.isEditMode = true;\r\n+    this.agenceForm.patchValue(this.agencyData);\r\n   }\r\n-  \r\n-\r\n-\r\n-onSubmit(): void {\r\n-  if (this.agenceForm.valid) {\r\n-    this.dialogRef.close(this.agenceForm.value);\r\n-  }\r\n }\r\n \r\n-close(): void {\r\n-  this.dialogRef.close();\r\n }\r\n \r\n \r\n-}\r\n-import { Component, Inject, OnInit } from '@angular/core';\r\n-import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n-import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n-import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n-\r\n-@Component({\r\n-  selector: 'app-agence-form',\r\n-  templateUrl: './agence-form.component.html',\r\n-  styleUrl: './agence-form.component.scss'\r\n-})\r\n-export class AgenceFormComponent implements OnInit {\r\n-  agenceForm: FormGroup;\r\n-  isEditMode = false;\r\n-  agencyData: any;\r\n-\r\n-  constructor(\r\n-    private fb: FormBuilder,\r\n-    public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n-    @Inject(MAT_DIALOG_DATA) public data: any\r\n-  ) {\r\n-    this.agenceForm = this.fb.group({\r\n-      name: ['', Validators.required],\r\n-      address: ['', Validators.required],\r\n-      email: ['', [Validators.required, Validators.email]],\r\n-      phone: ['', Validators.required]\r\n-    });\r\n-  }\r\n-\r\n-  ngOnInit(): void {\r\n-    if (this.agencyData) {\r\n-      this.isEditMode = true;\r\n-      this.agenceForm.patchValue(this.agencyData);\r\n-    }\r\n-  }\r\n-  \r\n-}\r\n-\r\n-\r\n onSubmit(): void {\r\n   if (this.agenceForm.valid) {\r\n     this.dialogRef.close(this.agenceForm.value);\r\n   }\r\n"
                },
                {
                    "date": 1744028277510,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,29 +12,33 @@\n   agenceForm: FormGroup;\r\n   isEditMode = false;\r\n   agencyData: any;\r\n \r\n-  constructor(\r\n-    private fb: FormBuilder,\r\n-    public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n-    @Inject(MAT_DIALOG_DATA) public data: any\r\n-  ) {\r\n-    this.agenceForm = this.fb.group({\r\n-      name: ['', Validators.required],\r\n-      address: ['', Validators.required],\r\n-      email: ['', [Validators.required, Validators.email]],\r\n-      phone: ['', Validators.required]\r\n-    });\r\n-  }\r\n+ constructor(\r\n+  private fb: FormBuilder,\r\n+  public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n+  @Inject(MAT_DIALOG_DATA) public data: any\r\n+) {\r\n+  this.agenceForm = this.fb.group({\r\n+    name: ['', Validators.required],\r\n+    address: ['', Validators.required],\r\n+    email: ['', [Validators.required, Validators.email]],\r\n+    phone: ['', Validators.required]\r\n+  });\r\n \r\n-  ngOnInit(): void {\r\n-  if (this.agencyData) {\r\n+  if (data?.isEditMode && data?.agencyData) {\r\n     this.isEditMode = true;\r\n-    this.agenceForm.patchValue(this.agencyData);\r\n+    this.agenceForm.patchValue(data.agencyData);\r\n   }\r\n }\r\n \r\n-}\r\n+  ngOnInit(): void {\r\n+    if (this.agencyData) {\r\n+      this.isEditMode = true;\r\n+      this.agenceForm.patchValue(this.agencyData);\r\n+    }\r\n+  }\r\n+  \r\n \r\n \r\n onSubmit(): void {\r\n   if (this.agenceForm.valid) {\r\n"
                },
                {
                    "date": 1744028285402,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,7 @@\n import { Component, Inject, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n-import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n   templateUrl: './agence-form.component.html',\r\n@@ -12,25 +11,25 @@\n   agenceForm: FormGroup;\r\n   isEditMode = false;\r\n   agencyData: any;\r\n \r\n- constructor(\r\n-  private fb: FormBuilder,\r\n-  public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n-  @Inject(MAT_DIALOG_DATA) public data: any\r\n-) {\r\n-  this.agenceForm = this.fb.group({\r\n-    name: ['', Validators.required],\r\n-    address: ['', Validators.required],\r\n-    email: ['', [Validators.required, Validators.email]],\r\n-    phone: ['', Validators.required]\r\n-  });\r\n-\r\n-  if (data?.isEditMode && data?.agencyData) {\r\n-    this.isEditMode = true;\r\n-    this.agenceForm.patchValue(data.agencyData);\r\n+  constructor(\r\n+    private fb: FormBuilder,\r\n+    public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n+    @Inject(MAT_DIALOG_DATA) public data: any\r\n+  ) {\r\n+    this.agenceForm = this.fb.group({\r\n+      name: ['', Validators.required],\r\n+      address: ['', Validators.required],\r\n+      email: ['', [Validators.required, Validators.email]],\r\n+      phone: ['', Validators.required]\r\n+    });\r\n+  \r\n+    if (data?.isEditMode && data?.agencyData) {\r\n+      this.isEditMode = true;\r\n+      this.agenceForm.patchValue(data.agencyData);\r\n+    }\r\n   }\r\n-}\r\n \r\n   ngOnInit(): void {\r\n     if (this.agencyData) {\r\n       this.isEditMode = true;\r\n"
                },
                {
                    "date": 1745064905991,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,10 +8,10 @@\n   styleUrl: './agence-form.component.scss'\r\n })\r\n export class AgenceFormComponent implements OnInit {\r\n   agenceForm: FormGroup;\r\n-  isEditMode = false;\r\n-  agencyData: any;\r\n+  @Input() isEditMode = false;\r\n+  @Input() agencyData: any;\r\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n     public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n"
                },
                {
                    "date": 1745064927752,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-import { Component, Inject, OnInit } from '@angular/core';\r\n+import { Component, Inject, Input, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n \r\n @Component({\r\n"
                },
                {
                    "date": 1745064935385,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,9 +14,9 @@\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n     public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n-    @Inject(MAT_DIALOG_DATA) public data: any\r\n+\r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n       address: ['', Validators.required],\r\n"
                },
                {
                    "date": 1745064944715,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,9 +13,9 @@\n   @Input() agencyData: any;\r\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n-    public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n+    public activeModal: NgbActiveModal\r\n \r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n"
                },
                {
                    "date": 1745064958301,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,8 @@\n import { Component, Inject, Input, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n+import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n   templateUrl: './agence-form.component.html',\r\n@@ -22,9 +23,9 @@\n       address: ['', Validators.required],\r\n       email: ['', [Validators.required, Validators.email]],\r\n       phone: ['', Validators.required]\r\n     });\r\n-  \r\n+  }\r\n     if (data?.isEditMode && data?.agencyData) {\r\n       this.isEditMode = true;\r\n       this.agenceForm.patchValue(data.agencyData);\r\n     }\r\n"
                },
                {
                    "date": 1745064975035,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,16 +24,12 @@\n       email: ['', [Validators.required, Validators.email]],\r\n       phone: ['', Validators.required]\r\n     });\r\n   }\r\n-    if (data?.isEditMode && data?.agencyData) {\r\n-      this.isEditMode = true;\r\n-      this.agenceForm.patchValue(data.agencyData);\r\n-    }\r\n-  }\r\n+    \r\n \r\n   ngOnInit(): void {\r\n-    if (this.agencyData) {\r\n+    if (this.isEditMode && this.agencyData) {\r\n       this.isEditMode = true;\r\n       this.agenceForm.patchValue(this.agencyData);\r\n     }\r\n   }\r\n"
                },
                {
                    "date": 1745064983883,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,8 @@\n     \r\n \r\n   ngOnInit(): void {\r\n     if (this.isEditMode && this.agencyData) {\r\n-      this.isEditMode = true;\r\n       this.agenceForm.patchValue(this.agencyData);\r\n     }\r\n   }\r\n   \r\n"
                },
                {
                    "date": 1745065002534,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,9 +36,9 @@\n \r\n \r\n onSubmit(): void {\r\n   if (this.agenceForm.valid) {\r\n-    this.dialogRef.close(this.agenceForm.value);\r\n+    this.activeModal.close(this.agenceForm.value);\r\n   }\r\n }\r\n \r\n close(): void {\r\n"
                },
                {
                    "date": 1745065009738,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -41,9 +41,9 @@\n   }\r\n }\r\n \r\n close(): void {\r\n-  this.dialogRef.close();\r\n+  this.activeModal.dismiss();\r\n }\r\n \r\n \r\n }\r\n"
                },
                {
                    "date": 1745065116371,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import { Component, Inject, Input, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n-import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n+import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog'\r\n import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n"
                },
                {
                    "date": 1745174706152,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,6 @@\n import { Component, Inject, Input, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n-import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog'\r\n import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n@@ -34,13 +33,37 @@\n   }\r\n   \r\n \r\n \r\n-onSubmit(): void {\r\n-  if (this.agenceForm.valid) {\r\n-    this.activeModal.close(this.agenceForm.value);\r\n+  onSubmit(): void {\r\n+    if (this.agenceForm.invalid) {\r\n+      return;\r\n+    }\r\n+\r\n+    const agenceData = this.agenceForm.value;\r\n+\r\n+    if (this.isEditMode && this.currentAgenceId) {\r\n+      this.agenceService.updateAgence(this.currentAgenceId, agenceData).subscribe({\r\n+        next: (response) => {\r\n+          console.log('Agence mise à jour:', response);\r\n+          this.router.navigate(['/liste-agences']);\r\n+        },\r\n+        error: (err) => {\r\n+          console.error('Erreur lors de la mise à jour:', err);\r\n+        }\r\n+      });\r\n+    } else {\r\n+      this.agenceService.createAgence(agenceData).subscribe({\r\n+        next: (response) => {\r\n+          console.log('Agence créée:', response);\r\n+          this.router.navigate(['/liste-agences']);\r\n+        },\r\n+        error: (err) => {\r\n+          console.error('Erreur lors de la création:', err);\r\n+        }\r\n+      });\r\n+    }\r\n   }\r\n-}\r\n \r\n close(): void {\r\n   this.activeModal.dismiss();\r\n }\r\n"
                },
                {
                    "date": 1745174718841,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,9 +13,10 @@\n   @Input() agencyData: any;\r\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n-    public activeModal: NgbActiveModal\r\n+    public activeModal: NgbActiveModal,\r\n+    private ag\r\n \r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n"
                },
                {
                    "date": 1745174724688,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,9 +14,9 @@\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n     public activeModal: NgbActiveModal,\r\n-    private ag\r\n+    private agenceService:Ag\r\n \r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n"
                },
                {
                    "date": 1745174744394,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,8 @@\n import { Component, Inject, Input, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n+import { AgenceService } from '../../services/agenceService';\r\n \r\n @Component({\r\n   selector: 'app-agence-form',\r\n   templateUrl: './agence-form.component.html',\r\n@@ -14,9 +15,9 @@\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n     public activeModal: NgbActiveModal,\r\n-    private agenceService:Ag\r\n+    private agenceService:AgenceService\r\n \r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n@@ -41,9 +42,9 @@\n     }\r\n \r\n     const agenceData = this.agenceForm.value;\r\n \r\n-    if (this.isEditMode && this.currentAgenceId) {\r\n+    if (this.isEditMode && this.agencyData) {\r\n       this.agenceService.updateAgence(this.currentAgenceId, agenceData).subscribe({\r\n         next: (response) => {\r\n           console.log('Agence mise à jour:', response);\r\n           this.router.navigate(['/liste-agences']);\r\n"
                },
                {
                    "date": 1745174765358,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,8 +31,9 @@\n   ngOnInit(): void {\r\n     if (this.isEditMode && this.agencyData) {\r\n       this.agenceForm.patchValue(this.agencyData);\r\n     }\r\n+  \r\n   }\r\n   \r\n \r\n \r\n@@ -42,9 +43,9 @@\n     }\r\n \r\n     const agenceData = this.agenceForm.value;\r\n \r\n-    if (this.isEditMode && this.agencyData) {\r\n+    if (this.isEditMode && this.agencyData.id) {\r\n       this.agenceService.updateAgence(this.currentAgenceId, agenceData).subscribe({\r\n         next: (response) => {\r\n           console.log('Agence mise à jour:', response);\r\n           this.router.navigate(['/liste-agences']);\r\n"
                },
                {
                    "date": 1745174770707,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,8 +30,9 @@\n \r\n   ngOnInit(): void {\r\n     if (this.isEditMode && this.agencyData) {\r\n       this.agenceForm.patchValue(this.agencyData);\r\n+      console.log()\r\n     }\r\n   \r\n   }\r\n   \r\n"
                },
                {
                    "date": 1745174778347,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n \r\n   ngOnInit(): void {\r\n     if (this.isEditMode && this.agencyData) {\r\n       this.agenceForm.patchValue(this.agencyData);\r\n-      console.log()\r\n+      console.log(\"agence\",this.)\r\n     }\r\n   \r\n   }\r\n   \r\n"
                },
                {
                    "date": 1745174795471,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n \r\n   ngOnInit(): void {\r\n     if (this.isEditMode && this.agencyData) {\r\n       this.agenceForm.patchValue(this.agencyData);\r\n-      console.log(\"agence\",this.)\r\n+      console.log(\"agence\",this.agencyData)\r\n     }\r\n   \r\n   }\r\n   \r\n@@ -44,9 +44,9 @@\n     }\r\n \r\n     const agenceData = this.agenceForm.value;\r\n \r\n-    if (this.isEditMode && this.agencyData.id) {\r\n+   /*  if (this.isEditMode && this.agencyData.id) {\r\n       this.agenceService.updateAgence(this.currentAgenceId, agenceData).subscribe({\r\n         next: (response) => {\r\n           console.log('Agence mise à jour:', response);\r\n           this.router.navigate(['/liste-agences']);\r\n@@ -64,9 +64,9 @@\n         error: (err) => {\r\n           console.error('Erreur lors de la création:', err);\r\n         }\r\n       });\r\n-    }\r\n+    } */\r\n   }\r\n \r\n close(): void {\r\n   this.activeModal.dismiss();\r\n"
                },
                {
                    "date": 1745174829950,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,12 +27,12 @@\n     });\r\n   }\r\n     \r\n \r\n-  ngOnInit(): void {\r\n+  ngOnInit(): void {console.log(\"agence\",this.agencyData)\r\n     if (this.isEditMode && this.agencyData) {\r\n       this.agenceForm.patchValue(this.agencyData);\r\n-      console.log(\"agence\",this.agencyData)\r\n+      \r\n     }\r\n   \r\n   }\r\n   \r\n"
                },
                {
                    "date": 1745174864820,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,9 +27,9 @@\n     });\r\n   }\r\n     \r\n \r\n-  ngOnInit(): void {console.log(\"agence\",this.agencyData)\r\n+  ngOnInit(): void {\r\n     if (this.isEditMode && this.agencyData) {\r\n       this.agenceForm.patchValue(this.agencyData);\r\n       \r\n     }\r\n"
                },
                {
                    "date": 1745175313583,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,8 +11,9 @@\n export class AgenceFormComponent implements OnInit {\r\n   agenceForm: FormGroup;\r\n   @Input() isEditMode = false;\r\n   @Input() agencyData: any;\r\n+  isLoading = false;\r\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n     public activeModal: NgbActiveModal,\r\n"
                },
                {
                    "date": 1745175341228,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,9 +16,10 @@\n \r\n   constructor(\r\n     private fb: FormBuilder,\r\n     public activeModal: NgbActiveModal,\r\n-    private agenceService:AgenceService\r\n+    private agenceService:AgenceService,\r\n+    private toastr: ToastrService\r\n \r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n"
                },
                {
                    "date": 1745175350250,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,9 @@\n   constructor(\r\n     private fb: FormBuilder,\r\n     public activeModal: NgbActiveModal,\r\n     private agenceService:AgenceService,\r\n-    private toastr: ToastrService\r\n+   \r\n \r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n       name: ['', Validators.required],\r\n"
                },
                {
                    "date": 1745175367626,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,10 +31,14 @@\n     \r\n \r\n   ngOnInit(): void {\r\n     if (this.isEditMode && this.agencyData) {\r\n-      this.agenceForm.patchValue(this.agencyData);\r\n-      \r\n+      this.agenceForm.patchValue({\r\n+        name: this.agencyData.name,\r\n+        address: this.agencyData.address,\r\n+        email: this.agencyData.email,\r\n+        phone: this.agencyData.phone\r\n+      });\r\n     }\r\n   \r\n   }\r\n   \r\n"
                },
                {
                    "date": 1745175406699,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,9 +38,61 @@\n         email: this.agencyData.email,\r\n         phone: this.agencyData.phone\r\n       });\r\n     }\r\n+    onSubmit(): void {\r\n+      if (this.agenceForm.invalid) {\r\n+        this.markFormGroupTouched(this.agenceForm);\r\n+        return;\r\n+      }\r\n   \r\n+      this.isLoading = true;\r\n+      const agenceData = this.agenceForm.value;\r\n+  \r\n+      if (this.isEditMode) {\r\n+        this.updateAgency(agenceData);\r\n+      } else {\r\n+        this.createAgency(agenceData);\r\n+      }\r\n+    }\r\n+  \r\n+    private createAgency(agenceData: any): void {\r\n+      this.agenceService.createAgence(agenceData).subscribe({\r\n+        next: (response) => {\r\n+          this.toastr.success('Agence créée avec succès');\r\n+          this.activeModal.close(response);\r\n+        },\r\n+        error: (err) => {\r\n+          this.toastr.error('Erreur lors de la création');\r\n+          console.error(err);\r\n+        },\r\n+        complete: () => this.isLoading = false\r\n+      });\r\n+    }\r\n+  \r\n+    private updateAgency(agenceData: any): void {\r\n+      this.agenceService.updateAgence(this.agencyData._id, agenceData).subscribe({\r\n+        next: (response) => {\r\n+          this.toastr.success('Agence mise à jour avec succès');\r\n+          this.activeModal.close(response);\r\n+        },\r\n+        error: (err) => {\r\n+          this.toastr.error('Erreur lors de la mise à jour');\r\n+          console.error(err);\r\n+        },\r\n+        complete: () => this.isLoading = false\r\n+      });\r\n+    }\r\n+  \r\n+    private markFormGroupTouched(formGroup: FormGroup): void {\r\n+      Object.values(formGroup.controls).forEach(control => {\r\n+        control.markAsTouched();\r\n+        if (control instanceof FormGroup) {\r\n+          this.markFormGroupTouched(control);\r\n+        }\r\n+      });\r\n+    }\r\n+  \r\n   }\r\n   \r\n \r\n \r\n"
                },
                {
                    "date": 1745175420195,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -95,38 +95,10 @@\n   }\r\n   \r\n \r\n \r\n-  onSubmit(): void {\r\n-    if (this.agenceForm.invalid) {\r\n-      return;\r\n-    }\r\n+  \r\n \r\n-    const agenceData = this.agenceForm.value;\r\n-\r\n-   /*  if (this.isEditMode && this.agencyData.id) {\r\n-      this.agenceService.updateAgence(this.currentAgenceId, agenceData).subscribe({\r\n-        next: (response) => {\r\n-          console.log('Agence mise à jour:', response);\r\n-          this.router.navigate(['/liste-agences']);\r\n-        },\r\n-        error: (err) => {\r\n-          console.error('Erreur lors de la mise à jour:', err);\r\n-        }\r\n-      });\r\n-    } else {\r\n-      this.agenceService.createAgence(agenceData).subscribe({\r\n-        next: (response) => {\r\n-          console.log('Agence créée:', response);\r\n-          this.router.navigate(['/liste-agences']);\r\n-        },\r\n-        error: (err) => {\r\n-          console.error('Erreur lors de la création:', err);\r\n-        }\r\n-      });\r\n-    } */\r\n-  }\r\n-\r\n close(): void {\r\n   this.activeModal.dismiss();\r\n }\r\n \r\n"
                },
                {
                    "date": 1745175425463,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,74 +31,46 @@\n     \r\n \r\n   ngOnInit(): void {\r\n     if (this.isEditMode && this.agencyData) {\r\n-      this.agenceForm.patchValue({\r\n-        name: this.agencyData.name,\r\n-        address: this.agencyData.address,\r\n-        email: this.agencyData.email,\r\n-        phone: this.agencyData.phone\r\n-      });\r\n+      this.agenceForm.patchValue(this.agencyData);\r\n+      \r\n     }\r\n-    onSubmit(): void {\r\n-      if (this.agenceForm.invalid) {\r\n-        this.markFormGroupTouched(this.agenceForm);\r\n-        return;\r\n-      }\r\n   \r\n-      this.isLoading = true;\r\n-      const agenceData = this.agenceForm.value;\r\n+  }\r\n   \r\n-      if (this.isEditMode) {\r\n-        this.updateAgency(agenceData);\r\n-      } else {\r\n-        this.createAgency(agenceData);\r\n-      }\r\n+\r\n+\r\n+  onSubmit(): void {\r\n+    if (this.agenceForm.invalid) {\r\n+      return;\r\n     }\r\n-  \r\n-    private createAgency(agenceData: any): void {\r\n-      this.agenceService.createAgence(agenceData).subscribe({\r\n+\r\n+    const agenceData = this.agenceForm.value;\r\n+\r\n+   /*  if (this.isEditMode && this.agencyData.id) {\r\n+      this.agenceService.updateAgence(this.currentAgenceId, agenceData).subscribe({\r\n         next: (response) => {\r\n-          this.toastr.success('Agence créée avec succès');\r\n-          this.activeModal.close(response);\r\n+          console.log('Agence mise à jour:', response);\r\n+          this.router.navigate(['/liste-agences']);\r\n         },\r\n         error: (err) => {\r\n-          this.toastr.error('Erreur lors de la création');\r\n-          console.error(err);\r\n-        },\r\n-        complete: () => this.isLoading = false\r\n+          console.error('Erreur lors de la mise à jour:', err);\r\n+        }\r\n       });\r\n-    }\r\n-  \r\n-    private updateAgency(agenceData: any): void {\r\n-      this.agenceService.updateAgence(this.agencyData._id, agenceData).subscribe({\r\n+    } else {\r\n+      this.agenceService.createAgence(agenceData).subscribe({\r\n         next: (response) => {\r\n-          this.toastr.success('Agence mise à jour avec succès');\r\n-          this.activeModal.close(response);\r\n+          console.log('Agence créée:', response);\r\n+          this.router.navigate(['/liste-agences']);\r\n         },\r\n         error: (err) => {\r\n-          this.toastr.error('Erreur lors de la mise à jour');\r\n-          console.error(err);\r\n-        },\r\n-        complete: () => this.isLoading = false\r\n-      });\r\n-    }\r\n-  \r\n-    private markFormGroupTouched(formGroup: FormGroup): void {\r\n-      Object.values(formGroup.controls).forEach(control => {\r\n-        control.markAsTouched();\r\n-        if (control instanceof FormGroup) {\r\n-          this.markFormGroupTouched(control);\r\n+          console.error('Erreur lors de la création:', err);\r\n         }\r\n       });\r\n-    }\r\n-  \r\n+    } */\r\n   }\r\n-  \r\n \r\n-\r\n-  \r\n-\r\n close(): void {\r\n   this.activeModal.dismiss();\r\n }\r\n \r\n"
                },
                {
                    "date": 1745175432658,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,46 +31,74 @@\n     \r\n \r\n   ngOnInit(): void {\r\n     if (this.isEditMode && this.agencyData) {\r\n-      this.agenceForm.patchValue(this.agencyData);\r\n-      \r\n+      this.agenceForm.patchValue({\r\n+        name: this.agencyData.name,\r\n+        address: this.agencyData.address,\r\n+        email: this.agencyData.email,\r\n+        phone: this.agencyData.phone\r\n+      });\r\n     }\r\n   \r\n   }\r\n   \r\n \r\n \r\n   onSubmit(): void {\r\n     if (this.agenceForm.invalid) {\r\n+      this.markFormGroupTouched(this.agenceForm);\r\n       return;\r\n     }\r\n \r\n+    this.isLoading = true;\r\n     const agenceData = this.agenceForm.value;\r\n \r\n-   /*  if (this.isEditMode && this.agencyData.id) {\r\n-      this.agenceService.updateAgence(this.currentAgenceId, agenceData).subscribe({\r\n-        next: (response) => {\r\n-          console.log('Agence mise à jour:', response);\r\n-          this.router.navigate(['/liste-agences']);\r\n-        },\r\n-        error: (err) => {\r\n-          console.error('Erreur lors de la mise à jour:', err);\r\n-        }\r\n-      });\r\n+    if (this.isEditMode) {\r\n+      this.updateAgency(agenceData);\r\n     } else {\r\n-      this.agenceService.createAgence(agenceData).subscribe({\r\n-        next: (response) => {\r\n-          console.log('Agence créée:', response);\r\n-          this.router.navigate(['/liste-agences']);\r\n-        },\r\n-        error: (err) => {\r\n-          console.error('Erreur lors de la création:', err);\r\n-        }\r\n-      });\r\n-    } */\r\n+      this.createAgency(agenceData);\r\n+    }\r\n   }\r\n \r\n+  private createAgency(agenceData: any): void {\r\n+    this.agenceService.createAgence(agenceData).subscribe({\r\n+      next: (response) => {\r\n+        this.toastr.success('Agence créée avec succès');\r\n+        this.activeModal.close(response);\r\n+      },\r\n+      error: (err) => {\r\n+        this.toastr.error('Erreur lors de la création');\r\n+        console.error(err);\r\n+      },\r\n+      complete: () => this.isLoading = false\r\n+    });\r\n+  }\r\n+\r\n+  private updateAgency(agenceData: any): void {\r\n+    this.agenceService.updateAgence(this.agencyData._id, agenceData).subscribe({\r\n+      next: (response) => {\r\n+        this.toastr.success('Agence mise à jour avec succès');\r\n+        this.activeModal.close(response);\r\n+      },\r\n+      error: (err) => {\r\n+        this.toastr.error('Erreur lors de la mise à jour');\r\n+        console.error(err);\r\n+      },\r\n+      complete: () => this.isLoading = false\r\n+    });\r\n+  }\r\n+\r\n+  private markFormGroupTouched(formGroup: FormGroup): void {\r\n+    Object.values(formGroup.controls).forEach(control => {\r\n+      control.markAsTouched();\r\n+      if (control instanceof FormGroup) {\r\n+        this.markFormGroupTouched(control);\r\n+      }\r\n+    });\r\n+  }\r\n+\r\n+\r\n close(): void {\r\n   this.activeModal.dismiss();\r\n }\r\n \r\n"
                },
                {
                    "date": 1745175448496,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,8 +17,9 @@\n   constructor(\r\n     private fb: FormBuilder,\r\n     public activeModal: NgbActiveModal,\r\n     private agenceService:AgenceService,\r\n+    private toastr: ToastrService\r\n    \r\n \r\n   ) {\r\n     this.agenceForm = this.fb.group({\r\n"
                },
                {
                    "date": 1745175469359,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n import { Component, Inject, Input, OnInit } from '@angular/core';\r\n import { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n import { AgenceService } from '../../services/agenceService';\r\n-\r\n+import { ToastrService } from 'ngx-toastr';\r\n @Component({\r\n   selector: 'app-agence-form',\r\n   templateUrl: './agence-form.component.html',\r\n   styleUrl: './agence-form.component.scss'\r\n"
                },
                {
                    "date": 1745187671446,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,21 +45,24 @@\n   \r\n \r\n \r\n   onSubmit(): void {\r\n-    if (this.agenceForm.invalid) {\r\n-      this.markFormGroupTouched(this.agenceForm);\r\n-      return;\r\n-    }\r\n-\r\n+    if (this.agenceForm.invalid) return;\r\n+  \r\n     this.isLoading = true;\r\n     const agenceData = this.agenceForm.value;\r\n-\r\n-    if (this.isEditMode) {\r\n-      this.updateAgency(agenceData);\r\n-    } else {\r\n-      this.createAgency(agenceData);\r\n-    }\r\n+  \r\n+    this.agenceService.createAgence(agenceData).subscribe({\r\n+      next: (response) => {\r\n+        this.toastr.success('Agence créée avec succès');\r\n+        this.activeModal.close(response);\r\n+      },\r\n+      error: (err) => {\r\n+        console.error('Erreur détaillée:', err);\r\n+        this.toastr.error(`Erreur: ${err.error?.message || err.message}`);\r\n+        this.isLoading = false;\r\n+      }\r\n+    });\r\n   }\r\n \r\n   private createAgency(agenceData: any): void {\r\n     this.agenceService.createAgence(agenceData).subscribe({\r\n"
                },
                {
                    "date": 1745187683751,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,26 +45,26 @@\n   \r\n \r\n \r\n   onSubmit(): void {\r\n-    if (this.agenceForm.invalid) return;\r\n-  \r\n-    this.isLoading = true;\r\n-    const agenceData = this.agenceForm.value;\r\n-  \r\n-    this.agenceService.createAgence(agenceData).subscribe({\r\n-      next: (response) => {\r\n-        this.toastr.success('Agence créée avec succès');\r\n-        this.activeModal.close(response);\r\n-      },\r\n-      error: (err) => {\r\n-        console.error('Erreur détaillée:', err);\r\n-        this.toastr.error(`Erreur: ${err.error?.message || err.message}`);\r\n-        this.isLoading = false;\r\n-      }\r\n-    });\r\n-  }\r\n+  if (this.agenceForm.invalid) return;\r\n \r\n+  this.isLoading = true;\r\n+  const agenceData = this.agenceForm.value;\r\n+\r\n+  this.agenceService.createAgence(agenceData).subscribe({\r\n+    next: (response) => {\r\n+      this.toastr.success('Agence créée avec succès');\r\n+      this.activeModal.close(response);\r\n+    },\r\n+    error: (err) => {\r\n+      console.error('Erreur détaillée:', err);\r\n+      this.toastr.error(`Erreur: ${err.error?.message || err.message}`);\r\n+      this.isLoading = false;\r\n+    }\r\n+  });\r\n+}\r\n+\r\n   private createAgency(agenceData: any): void {\r\n     this.agenceService.createAgence(agenceData).subscribe({\r\n       next: (response) => {\r\n         this.toastr.success('Agence créée avec succès');\r\n"
                },
                {
                    "date": 1745243792623,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,25 +45,25 @@\n   \r\n \r\n \r\n   onSubmit(): void {\r\n-  if (this.agenceForm.invalid) return;\r\n+    if (this.agenceForm.invalid) {\r\n+      this.markFormGroupTouched(this.agenceForm);\r\n+      return;\r\n+    }\r\n \r\n-  this.isLoading = true;\r\n-  const agenceData = this.agenceForm.value;\r\n+    this.isLoading = true;\r\n+    const agenceData = {\r\n+      ...this.agenceForm.value,\r\n+      createdAt: new Date().toISOString() // Ajoute la date actuelle\r\n+    };\r\n \r\n-  this.agenceService.createAgence(agenceData).subscribe({\r\n-    next: (response) => {\r\n-      this.toastr.success('Agence créée avec succès');\r\n-      this.activeModal.close(response);\r\n-    },\r\n-    error: (err) => {\r\n-      console.error('Erreur détaillée:', err);\r\n-      this.toastr.error(`Erreur: ${err.error?.message || err.message}`);\r\n-      this.isLoading = false;\r\n+    if (this.isEditMode) {\r\n+      this.updateAgency(agenceData);\r\n+    } else {\r\n+      this.createAgency(agenceData);\r\n     }\r\n-  });\r\n-}\r\n+  }\r\n \r\n   private createAgency(agenceData: any): void {\r\n     this.agenceService.createAgence(agenceData).subscribe({\r\n       next: (response) => {\r\n"
                },
                {
                    "date": 1745244714207,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,10 +51,9 @@\n       return;\r\n     }\r\n \r\n     this.isLoading = true;\r\n-    const agenceData = {\r\n-      ...this.agenceForm.value,\r\n+    const agenceData = this.agenceForm.value,\r\n       createdAt: new Date().toISOString() // Ajoute la date actuelle\r\n     };\r\n \r\n     if (this.isEditMode) {\r\n"
                },
                {
                    "date": 1745244719412,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,11 +51,10 @@\n       return;\r\n     }\r\n \r\n     this.isLoading = true;\r\n-    const agenceData = this.agenceForm.value,\r\n-      createdAt: new Date().toISOString() // Ajoute la date actuelle\r\n-    };\r\n+    const agenceData = this.agenceForm.value;\r\n+     \r\n \r\n     if (this.isEditMode) {\r\n       this.updateAgency(agenceData);\r\n     } else {\r\n"
                },
                {
                    "date": 1745275821468,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -52,9 +52,8 @@\n     }\r\n \r\n     this.isLoading = true;\r\n     const agenceData = this.agenceForm.value;\r\n-     \r\n \r\n     if (this.isEditMode) {\r\n       this.updateAgency(agenceData);\r\n     } else {\r\n"
                },
                {
                    "date": 1745282066497,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,9 +51,12 @@\n       return;\r\n     }\r\n \r\n     this.isLoading = true;\r\n-    const agenceData = this.agenceForm.value;\r\n+    const agenceData = {\r\n+      ...this.agenceForm.value,\r\n+      id: this.agencyData?.id // On conserve l'ID existant en mode édition\r\n+    };\r\n \r\n     if (this.isEditMode) {\r\n       this.updateAgency(agenceData);\r\n     } else {\r\n"
                },
                {
                    "date": 1745282084632,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -78,18 +78,17 @@\n     });\r\n   }\r\n \r\n   private updateAgency(agenceData: any): void {\r\n-    this.agenceService.updateAgence(this.agencyData._id, agenceData).subscribe({\r\n+    this.agenceService.updateAgence(this.agencyData.id, agenceData).subscribe({\r\n       next: (response) => {\r\n         this.toastr.success('Agence mise à jour avec succès');\r\n         this.activeModal.close(response);\r\n       },\r\n       error: (err) => {\r\n-        this.toastr.error('Erreur lors de la mise à jour');\r\n-        console.error(err);\r\n-      },\r\n-      complete: () => this.isLoading = false\r\n+        this.toastr.error('Erreur lors de la mise à jour: ' + err.message);\r\n+        this.isLoading = false;\r\n+      }\r\n     });\r\n   }\r\n \r\n   private markFormGroupTouched(formGroup: FormGroup): void {\r\n"
                }
            ],
            "date": 1744024184352,
            "name": "Commit-0",
            "content": "import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-agence-form',\r\n  templateUrl: './agence-form.component.html',\r\n  styleUrl: './agence-form.component.scss'\r\n})\r\nexport class AgenceFormComponent implements OnInit {\r\n  agenceForm: FormGroup;\r\n  isEditMode = false;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    public dialogRef: MatDialogRef<AgenceFormComponent>,\r\n    @Inject(MAT_DIALOG_DATA) public data: any\r\n  ) {\r\n    this.agenceForm = this.fb.group({\r\n      name: ['', Validators.required],\r\n      address: ['', Validators.required],\r\n      email: ['', [Validators.required, Validators.email]],\r\n      phone: ['', Validators.required],\r\n    });\r\n\r\n    if (data?.agency) {\r\n      this.isEditMode = true;\r\n      this.agenceForm.patchValue(data.agency);\r\n    }\r\n  }\r\n\r\n  ngOnInit(): void {}\r\n\r\n  onSubmit() {\r\n    if (this.agenceForm.valid) {\r\n      this.dialogRef.close(this.agenceForm.value);\r\n    }\r\n  }\r\n\r\n}\r\n"
        }
    ]
}